name: github_search
display_name: GitHub Secret Search
version: 1.0.0
description: >
  Searches GitHub repositories for potential exposed secrets, API keys,
  credentials, and other sensitive information.

author: CyberAgents Security Team
license: MIT

# Tool capabilities
capabilities:
  - github_repository_search
  - secret_detection
  - credential_exposure_analysis

# Input parameters schema
input_schema:
  type: string
  description: >
    Input should be a GitHub repository identifier in one of these formats:
    - "repo:<owner>/<repo>" to search within a specific repository
    - "owner:<owner>" to search across all repositories of an owner/organization
    - "query:<search_query>" to search GitHub with a custom query

    Example inputs:
    - "repo:organization/repository-name"
    - "owner:username"
    - "query:aws_secret_access_key in:file language:yaml"

# API requirements
api_requirements:
  - name: GITHUB_TOKEN
    description: GitHub personal access token for API authentication
    required: false

# Dependencies
dependencies:
  python:
    - requests>=2.25.0
    - langchain>=0.0.139

# Usage examples
examples:
  - description: Search a specific repository for sensitive information
    input: "repo:NaorPenso/CyberAgents"
    expected_output: "## GitHub Repository Analysis..."

  - description: Search all repositories owned by a user
    input: "owner:NaorPenso"
    expected_output: "## GitHub User/Organization Analysis..."

  - description: Execute a custom search query
    input: "query:password in:file org:NaorPenso"
    expected_output: "## GitHub Custom Search Results..."

# Additional configurations
settings:
  max_results_per_query: 30
  rate_limit_handling: true
  include_forks: false

# Related tools
related_tools:
  - trufflehog_scanner
