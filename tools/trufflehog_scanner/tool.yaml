name: trufflehog_scanner
display_name: TruffleHog Secret Scanner
version: 1.0.0
description: >
  Scans Git repositories for exposed secrets, credentials, and other sensitive
  information using TruffleHog.

author: CyberAgents Security Team
license: MIT

# Tool capabilities
capabilities:
  - git_repository_scanning
  - secret_detection
  - credential_exposure_analysis
  - policy_based_scanning

# Input parameters schema
input_schema:
  type: string
  description: >
    Input should be a repository target in one of these formats:
    - "github:<owner>/<repo>" to scan a GitHub repository
    - "gitlab:<owner>/<repo>" to scan a GitLab repository
    - "local:<path>" to scan a local repository

    Example inputs:
    - "github:organization/repository-name"
    - "local:/path/to/local/repository"

# Dependencies
dependencies:
  os:
    - git
  python:
    - trufflehog>=3.0.0
    - pyyaml>=5.1.0
    - langchain>=0.0.139

# Usage examples
examples:
  - description: Scan a GitHub repository
    input: "github:NaorPenso/CyberAgents"
    expected_output: "### Scan Results..."

  - description: Scan a GitLab repository
    input: "gitlab:user/repo"
    expected_output: "### Scan Results..."

  - description: Scan a local repository
    input: "local:/path/to/local/repo"
    expected_output: "### Scan Results..."

# Additional configurations
settings:
  rules_source: "agents/git_exposure_analyst_agent/knowledge/policy"
  scan_depth: 50
  include_historical: true
  entropy_checks: true
  regex_rules: true
  max_findings: 50

# Related tools
related_tools:
  - github_search
