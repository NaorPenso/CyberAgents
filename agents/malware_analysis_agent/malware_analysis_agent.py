"""Malware Analysis Agent specialized in analyzing malicious software and code.

This agent identifies, analyzes, and reports on malware characteristics, behaviors,
and potential threats posed by suspicious files and code.
"""

import logging

from crewai import Agent

from ..base_agent import BaseAgent
from utils.llm_utils import create_llm

logger = logging.getLogger(__name__)


class MalwareAnalysisAgent(BaseAgent):
    """Agent specialized in malware analysis and threat detection.

    Examines suspicious files, code and binaries to determine malicious behaviors
    and potential impact.
    """

    def __init__(self):
        """Initialize the Malware Analysis Agent."""
        super().__init__()

        # Initialize tools here if needed
        # self.tool = SomeMalwareTool()

        self.agent = Agent(
            role="Malware Analyst",
            goal="Analyze suspicious code and files to identify malicious capabilities and behaviors.",
            backstory=(
                "You are an experienced malware analyst with deep expertise in reverse "
                "engineering and behavioral analysis. You excel at identifying malicious "
                "code patterns, determining malware capabilities, and assessing potential "
                "threats posed by suspicious files."
            ),
            tools=[],  # Add specific tools once implemented
            verbose=True,
            allow_delegation=False,
            llm=create_llm()
        )

        self.agent_name = "MalwareAnalysisAgent"
        self.agent_role = "Malware Analyst"
        self.agent_goal = "Analyze suspicious code and files to identify malicious capabilities and behaviors."
        self.agent_backstory = (
            "An expert malware analyst with years of experience analyzing and dissecting "
            "malicious code. You excel at identifying malware techniques, behaviors and "
            "capabilities, providing detailed technical assessments of potential threats."
        )

        logger.info("Malware Analysis Agent initialized")
